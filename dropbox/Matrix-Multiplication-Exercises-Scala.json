{"paragraphs":[{"text":"import org.apache.spark.rdd.RDD\nimport org.apache.spark.mllib.linalg.distributed.{BlockMatrix, CoordinateMatrix, MatrixEntry}","user":"anonymous","dateUpdated":"2018-08-17T23:08:30+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.rdd.RDD\nimport org.apache.spark.mllib.linalg.distributed.{BlockMatrix, CoordinateMatrix, MatrixEntry}\n"}]},"apps":[],"jobName":"paragraph_1534545056071_496242520","id":"20180816-051038_545285622","dateCreated":"2018-08-17T22:30:56+0000","dateStarted":"2018-08-17T23:08:30+0000","dateFinished":"2018-08-17T23:08:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:201"},{"text":"val green_location_value = Seq(MatrixEntry(0,0,21), MatrixEntry(1,0,23), MatrixEntry(0,1,22), MatrixEntry(1,1,24))\nval blue_location_value = Seq(MatrixEntry(0,0,11), MatrixEntry(1,0,13), MatrixEntry(0,1,12), MatrixEntry(1,1,14))\nval orange_location_value = Seq(MatrixEntry(0,0,0.4), MatrixEntry(1,0,0.2), MatrixEntry(0,1,0.3), MatrixEntry(1,1,0.1))\nval brown_location_value = Seq(MatrixEntry(0,0,4), MatrixEntry(1,0,2), MatrixEntry(0,1,3), MatrixEntry(1,1,1))\n","user":"anonymous","dateUpdated":"2018-08-17T23:08:32+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"green_location_value: Seq[org.apache.spark.mllib.linalg.distributed.MatrixEntry] = List(MatrixEntry(0,0,21.0), MatrixEntry(1,0,23.0), MatrixEntry(0,1,22.0), MatrixEntry(1,1,24.0))\nblue_location_value: Seq[org.apache.spark.mllib.linalg.distributed.MatrixEntry] = List(MatrixEntry(0,0,11.0), MatrixEntry(1,0,13.0), MatrixEntry(0,1,12.0), MatrixEntry(1,1,14.0))\norange_location_value: Seq[org.apache.spark.mllib.linalg.distributed.MatrixEntry] = List(MatrixEntry(0,0,0.4), MatrixEntry(1,0,0.2), MatrixEntry(0,1,0.3), MatrixEntry(1,1,0.1))\nbrown_location_value: Seq[org.apache.spark.mllib.linalg.distributed.MatrixEntry] = List(MatrixEntry(0,0,4.0), MatrixEntry(1,0,2.0), MatrixEntry(0,1,3.0), MatrixEntry(1,1,1.0))\n"}]},"apps":[],"jobName":"paragraph_1534545056073_493934027","id":"20180816-051431_1380261728","dateCreated":"2018-08-17T22:30:56+0000","dateStarted":"2018-08-17T23:08:32+0000","dateFinished":"2018-08-17T23:08:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:203"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1534547239191_-1748305418","id":"20180817-230719_358720714","dateCreated":"2018-08-17T23:07:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2018","text":"val green = sc.parallelize(green_location_value)\nval blue = sc.parallelize(blue_location_value)\nval orange = sc.parallelize(orange_location_value)\nval brown = sc.parallelize(brown_location_value)","dateUpdated":"2018-08-17T23:08:36+0000","dateFinished":"2018-08-17T23:08:37+0000","dateStarted":"2018-08-17T23:08:36+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"green: org.apache.spark.rdd.RDD[org.apache.spark.mllib.linalg.distributed.MatrixEntry] = ParallelCollectionRDD[224] at parallelize at <console>:33\nblue: org.apache.spark.rdd.RDD[org.apache.spark.mllib.linalg.distributed.MatrixEntry] = ParallelCollectionRDD[225] at parallelize at <console>:33\norange: org.apache.spark.rdd.RDD[org.apache.spark.mllib.linalg.distributed.MatrixEntry] = ParallelCollectionRDD[226] at parallelize at <console>:33\nbrown: org.apache.spark.rdd.RDD[org.apache.spark.mllib.linalg.distributed.MatrixEntry] = ParallelCollectionRDD[227] at parallelize at <console>:33\n"}]}},{"text":"def create_blockMatrix(matrixEntries:RDD[MatrixEntry]) : BlockMatrix = new CoordinateMatrix(matrixEntries).toBlockMatrix()","user":"anonymous","dateUpdated":"2018-08-17T22:39:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"create_blockMatrix: (matrixEntries: org.apache.spark.rdd.RDD[org.apache.spark.mllib.linalg.distributed.MatrixEntry])org.apache.spark.mllib.linalg.distributed.BlockMatrix\n"}]},"apps":[],"jobName":"paragraph_1534545056078_493549278","id":"20180816-051640_149771352","dateCreated":"2018-08-17T22:30:56+0000","dateStarted":"2018-08-17T22:39:57+0000","dateFinished":"2018-08-17T22:39:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:207"},{"text":"val block_green: BlockMatrix = create_blockMatrix(green)\nval block_blue: BlockMatrix = create_blockMatrix(blue)\nval block_orange: BlockMatrix = create_blockMatrix(orange)\nval block_brown: BlockMatrix = create_blockMatrix(brown)","user":"anonymous","dateUpdated":"2018-08-17T23:08:48+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"block_green: org.apache.spark.mllib.linalg.distributed.BlockMatrix = org.apache.spark.mllib.linalg.distributed.BlockMatrix@a0fa5a\nblock_blue: org.apache.spark.mllib.linalg.distributed.BlockMatrix = org.apache.spark.mllib.linalg.distributed.BlockMatrix@4dabafad\nblock_orange: org.apache.spark.mllib.linalg.distributed.BlockMatrix = org.apache.spark.mllib.linalg.distributed.BlockMatrix@fab2537\nblock_brown: org.apache.spark.mllib.linalg.distributed.BlockMatrix = org.apache.spark.mllib.linalg.distributed.BlockMatrix@116416b6\n"}]},"apps":[],"jobName":"paragraph_1534545056079_493164529","id":"20180816-053544_199438445","dateCreated":"2018-08-17T22:30:56+0000","dateStarted":"2018-08-17T23:08:46+0000","dateFinished":"2018-08-17T23:08:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:209"},{"text":"val output_matrix = block_green.multiply(block_blue).multiply(block_orange).multiply(block_brown)\noutput_matrix.toLocalMatrix()","user":"anonymous","dateUpdated":"2018-08-17T23:26:29+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"output_matrix: org.apache.spark.mllib.linalg.distributed.BlockMatrix = org.apache.spark.mllib.linalg.distributed.BlockMatrix@75d362a\nres9: org.apache.spark.mllib.linalg.Matrix =\n1697.4  1167.5\n1855.0  1275.8999999999999\n"}]},"apps":[],"jobName":"paragraph_1534545056080_503552749","id":"20180816-054044_1121238451","dateCreated":"2018-08-17T22:30:56+0000","dateStarted":"2018-08-17T23:09:26+0000","dateFinished":"2018-08-17T23:09:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:211"},{"text":"val bucket = \"gs://de-training-output-fherdelpino/matrix-multiplication-exercise-result\"\noutput_matrix.toCoordinateMatrix().entries.saveAsTextFile(bucket)","dateUpdated":"2018-08-17T23:09:26+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"bucket: String = gs://de-training-output-<user-name>/matrix-multiplication-exercise-result\njava.lang.IllegalArgumentException: Invalid bucket name (de-training-output-<user-name>) or object name ()\n  at com.google.cloud.hadoop.gcsio.LegacyPathCodec.getPath(LegacyPathCodec.java:99)\n  at com.google.cloud.hadoop.fs.gcs.GoogleHadoopFileSystem.configureBuckets(GoogleHadoopFileSystem.java:75)\n  at com.google.cloud.hadoop.fs.gcs.GoogleHadoopFileSystemBase.configure(GoogleHadoopFileSystemBase.java:2011)\n  at com.google.cloud.hadoop.fs.gcs.GoogleHadoopFileSystemBase.initialize(GoogleHadoopFileSystemBase.java:1102)\n  at com.google.cloud.hadoop.fs.gcs.GoogleHadoopFileSystemBase.initialize(GoogleHadoopFileSystemBase.java:1065)\n  at org.apache.hadoop.fs.FileSystem.createFileSystem(FileSystem.java:2812)\n  at org.apache.hadoop.fs.FileSystem.access$200(FileSystem.java:100)\n  at org.apache.hadoop.fs.FileSystem$Cache.getInternal(FileSystem.java:2849)\n  at org.apache.hadoop.fs.FileSystem$Cache.get(FileSystem.java:2831)\n  at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:389)\n  at org.apache.hadoop.fs.Path.getFileSystem(Path.java:356)\n  at org.apache.spark.internal.io.SparkHadoopWriterUtils$.createPathFromString(SparkHadoopWriterUtils.scala:55)\n  at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$4.apply$mcV$sp(PairRDDFunctions.scala:1069)\n  at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$4.apply(PairRDDFunctions.scala:1035)\n  at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$4.apply(PairRDDFunctions.scala:1035)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n  at org.apache.spark.rdd.PairRDDFunctions.saveAsHadoopFile(PairRDDFunctions.scala:1035)\n  at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$1.apply$mcV$sp(PairRDDFunctions.scala:961)\n  at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$1.apply(PairRDDFunctions.scala:961)\n  at org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$1.apply(PairRDDFunctions.scala:961)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n  at org.apache.spark.rdd.PairRDDFunctions.saveAsHadoopFile(PairRDDFunctions.scala:960)\n  at org.apache.spark.rdd.RDD$$anonfun$saveAsTextFile$1.apply$mcV$sp(RDD.scala:1489)\n  at org.apache.spark.rdd.RDD$$anonfun$saveAsTextFile$1.apply(RDD.scala:1468)\n  at org.apache.spark.rdd.RDD$$anonfun$saveAsTextFile$1.apply(RDD.scala:1468)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n  at org.apache.spark.rdd.RDD.saveAsTextFile(RDD.scala:1468)\n  ... 48 elided\nCaused by: java.net.URISyntaxException: Illegal character in authority at index 5: gs://de-training-output-<user-name>/\n  at java.net.URI$Parser.fail(URI.java:2848)\n  at java.net.URI$Parser.parseAuthority(URI.java:3186)\n  at java.net.URI$Parser.parseHierarchical(URI.java:3097)\n  at java.net.URI$Parser.parse(URI.java:3053)\n  at java.net.URI.<init>(URI.java:588)\n  at com.google.cloud.hadoop.gcsio.LegacyPathCodec.getPath(LegacyPathCodec.java:93)\n  ... 80 more\n"}]},"apps":[],"jobName":"paragraph_1534545056081_503168000","id":"20180816-055550_1811176051","dateCreated":"2018-08-17T22:30:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:213"},{"text":"def matrix_exponent(exponent:Int,matrixToMultiply:BlockMatrix) : BlockMatrix = {\n    if (exponent == 1)\n        matrixToMultiply\n    else\n        matrix_exponent(exponent-1,matrixToMultiply.multiply(matrixToMultiply))\n}","user":"anonymous","dateUpdated":"2018-08-17T23:12:35+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false},"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"matrix_exponent: (exponent: Int, matrixToMultiply: org.apache.spark.mllib.linalg.distributed.BlockMatrix)org.apache.spark.mllib.linalg.distributed.BlockMatrix\n"}]},"apps":[],"jobName":"paragraph_1534545056082_504322247","id":"20180816-055548_1870600573","dateCreated":"2018-08-17T22:30:56+0000","dateStarted":"2018-08-17T22:44:22+0000","dateFinished":"2018-08-17T22:44:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:216"},{"text":"matrix_exponent(1,block_green).toLocalMatrix()","user":"anonymous","dateUpdated":"2018-08-17T23:23:49+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res14: org.apache.spark.mllib.linalg.Matrix =\n21.0  22.0\n23.0  24.0\n"}]},"apps":[],"jobName":"paragraph_1534545056083_503937498","id":"20180816-060847_989894645","dateCreated":"2018-08-17T22:30:56+0000","dateStarted":"2018-08-17T23:16:07+0000","dateFinished":"2018-08-17T23:16:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:218"},{"text":"val exercise2 = matrix_exponent(2,block_green).multiply(matrix_exponent(2,block_blue)).multiply(matrix_exponent(2,block_orange)).multiply(matrix_exponent(2,block_brown))\nexercise2.toLocalMatrix()\nexercise2.blocks.collect()","user":"anonymous","dateUpdated":"2018-08-17T23:26:23+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"exercise2: org.apache.spark.mllib.linalg.distributed.BlockMatrix = org.apache.spark.mllib.linalg.distributed.BlockMatrix@6fca1367\nres6: org.apache.spark.mllib.linalg.Matrix =\n5368279.460000001  3683434.3500000006\n6298662.900000001  4321815.110000001\n"}]},"apps":[],"jobName":"paragraph_1534545056084_502013754","id":"20180816-061358_1587903354","dateCreated":"2018-08-17T22:30:56+0000","dateStarted":"2018-08-17T22:56:28+0000","dateFinished":"2018-08-17T22:56:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:220"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","tableHide":false,"title":false,"lineNumbers":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1534547892897_-1757018370","id":"20180817-231812_759298464","dateCreated":"2018-08-17T23:18:12+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2570","dateUpdated":"2018-08-17T23:26:23+0000","text":"val bucket = \"gs://de-training-output-fherdelpino/matrix-multiplication-exercise3-resultv3\"\nexercise2.toCoordinateMatrix().entries.saveAsTextFile(bucket)"}],"name":"Matrix-Multiplication-Exercises-Scala","id":"2DQK7AK62","angularObjects":{"2DPCN9GEK:shared_process":[],"2DPMUM1MZ:shared_process":[],"2DQ4KSB5A:shared_process":[],"2DQKFUJ2S:shared_process":[],"2DM9MWDXS:shared_process":[],"2DQVUYZCR:shared_process":[],"2DNWNF1WW:shared_process":[],"2DQ3DG8SW:shared_process":[],"2DQBDSTJM:shared_process":[],"2DNK4KEA9:shared_process":[],"2DM7JTMMG:shared_process":[],"2DQD5P7ZJ:shared_process":[],"2DPYVSA4H:shared_process":[],"2DNANZ78K:shared_process":[],"2DMTDPCE2:shared_process":[],"2DQRRUZW3:shared_process":[],"2DNN66569:shared_process":[],"2DP2CKC1H:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}