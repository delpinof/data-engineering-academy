{"paragraphs":[{"text":"import org.apache.spark.sql.{Dataset,Row,SaveMode}\r\nimport org.apache.spark.sql.types.{StructType, StringType, TimestampType, IntegerType, DoubleType}\r\nimport java.util.Calendar\r\nimport java.sql.Timestamp","user":"anonymous","dateUpdated":"2018-08-25T21:10:39+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.{Dataset, Row, SaveMode}\nimport org.apache.spark.sql.types.{StructType, StringType, TimestampType, IntegerType, DoubleType}\nimport java.util.Calendar\nimport java.sql.Timestamp\n"}]},"apps":[],"jobName":"paragraph_1535221455627_-1830645030","id":"20180823-200151_1198247100","dateCreated":"2018-08-25T18:24:15+0000","dateStarted":"2018-08-25T21:10:39+0000","dateFinished":"2018-08-25T21:10:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7853"},{"text":"//Schema to parse the json\nval schema = (new StructType).add(\"id\", StringType).add(\"client_id\",StringType).add(\"timestamp\", TimestampType).add(\"product_id\",StringType).add(\"quantity\",IntegerType).add(\"total\",DoubleType)","user":"anonymous","dateUpdated":"2018-08-25T21:10:39+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"schema: org.apache.spark.sql.types.StructType = StructType(StructField(id,StringType,true), StructField(client_id,StringType,true), StructField(timestamp,TimestampType,true), StructField(product_id,StringType,true), StructField(quantity,IntegerType,true), StructField(total,DoubleType,true))\n"}]},"apps":[],"jobName":"paragraph_1535221455638_-1822565303","id":"20180823-203842_251036642","dateCreated":"2018-08-25T18:24:15+0000","dateStarted":"2018-08-25T21:10:39+0000","dateFinished":"2018-08-25T21:10:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7854"},{"text":"//Import the data into DataFrame\r\nval ordersDF = spark.read.schema(schema).json(\"gs://de-training-input/alimazon/200000/client-orders/part_20180820T15465*.jsonl.gz\")","user":"anonymous","dateUpdated":"2018-08-25T21:10:39+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ordersDF: org.apache.spark.sql.DataFrame = [id: string, client_id: string ... 4 more fields]\n"}]},"apps":[],"jobName":"paragraph_1535221455638_-1822565303","id":"20180823-195629_1181918868","dateCreated":"2018-08-25T18:24:15+0000","dateStarted":"2018-08-25T21:10:40+0000","dateFinished":"2018-08-25T21:10:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7855"},{"text":"//Function converts timestamp to day of the week\r\ndef dayOfWeek(t:Timestamp) : Int = {\r\n            val c = Calendar.getInstance()\r\n            c.setTime(t)\r\n            c.get(Calendar.DAY_OF_WEEK)\r\n        }","user":"anonymous","dateUpdated":"2018-08-25T21:10:39+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"dayOfWeek: (t: java.sql.Timestamp)Int\n"}]},"apps":[],"jobName":"paragraph_1535221455639_-1822950052","id":"20180823-200007_318589196","dateCreated":"2018-08-25T18:24:15+0000","dateStarted":"2018-08-25T21:10:40+0000","dateFinished":"2018-08-25T21:10:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7856"},{"text":"//Function converts timestamp to month number\r\ndef getMonth(t:Timestamp) : Int = {\r\n            val c = Calendar.getInstance()\r\n            c.setTime(t)\r\n            c.get(Calendar.MONTH)+1\r\n        }","user":"anonymous","dateUpdated":"2018-08-25T21:10:39+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"},"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"getMonth: (t: java.sql.Timestamp)Int\n"}]},"apps":[],"jobName":"paragraph_1535221455639_-1822950052","id":"20180823-211618_1799232573","dateCreated":"2018-08-25T18:24:15+0000","dateStarted":"2018-08-25T21:10:41+0000","dateFinished":"2018-08-25T21:10:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7857"},{"text":"//Function to save to a file in CVS format\r\ndef saveToFile(ds:Dataset[Row],filename:String) = {\r\n            ds.write.mode(SaveMode.Overwrite)\r\n        \t   .format(\"com.databricks.spark.csv\")\r\n        \t   .option(\"header\", true)\r\n        \t   .option(\"delimiter\", \",\")\r\n        \t   .save(s\"gs://de-training-output-fherdelpino/assignment-3-tst/$filename\")\r\n}","user":"anonymous","dateUpdated":"2018-08-25T21:10:39+0000","config":{"tableHide":false,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"saveToFile: (ds: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row], filename: String)Unit\n"}]},"apps":[],"jobName":"paragraph_1535221455641_-1825258546","id":"20180823-202120_766480087","dateCreated":"2018-08-25T18:24:15+0000","dateStarted":"2018-08-25T21:10:42+0000","dateFinished":"2018-08-25T21:10:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7860","focus":true},{"text":"case class OrderRowSimple(day_of_week:Int,month:Int,client_id:String,product_id:String,total:Double)","user":"anonymous","dateUpdated":"2018-08-25T21:10:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class OrderRowSimple\n"}]},"apps":[],"jobName":"paragraph_1535222016352_-1679041928","id":"20180825-183336_835014079","dateCreated":"2018-08-25T18:33:36+0000","dateStarted":"2018-08-25T21:10:42+0000","dateFinished":"2018-08-25T21:10:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7858"},{"text":"//Create Dataset\r\nval ordersDSsimple = ordersDF.map(row => OrderRowSimple(\r\n                dayOfWeek(row.getAs[Timestamp](2)),\r\n                getMonth(row.getAs[Timestamp](2)),\r\n                row.getAs[String](1),\r\n                row.getAs[String](3),\r\n                row.getAs[Double](5)\r\n            )\r\n        )","user":"anonymous","dateUpdated":"2018-08-25T21:10:39+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ordersDSsimple: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1535221455640_-1824873797","id":"20180823-200223_457808744","dateCreated":"2018-08-25T18:24:15+0000","dateStarted":"2018-08-25T21:10:42+0000","dateFinished":"2018-08-25T21:10:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7859"},{"text":"val ordersByWeek1 = ordersDSsimple.filter(r => r.day_of_week == 1)\nval ordersByWeek2 = ordersDSsimple.filter(r => r.day_of_week == 2)\nval ordersByWeek3 = ordersDSsimple.filter(r => r.day_of_week == 3)\nval ordersByWeek4 = ordersDSsimple.filter(r => r.day_of_week == 4)\nval ordersByWeek5 = ordersDSsimple.filter(r => r.day_of_week == 5)\nval ordersByWeek6 = ordersDSsimple.filter(r => r.day_of_week == 6)\nval ordersByWeek7 = ordersDSsimple.filter(r => r.day_of_week == 7)","user":"anonymous","dateUpdated":"2018-08-25T21:10:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ordersByWeek1: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByWeek2: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByWeek3: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByWeek4: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByWeek5: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByWeek6: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByWeek7: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1535222409996_-156988436","id":"20180825-184009_918476543","dateCreated":"2018-08-25T18:40:09+0000","dateStarted":"2018-08-25T21:10:42+0000","dateFinished":"2018-08-25T21:10:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7864"},{"user":"anonymous","config":{"colWidth":12,"enabled":false,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535230947975_-1191229135","id":"20180825-210227_1257245421","dateCreated":"2018-08-25T21:02:27+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8407","text":"ordersByWeek1.cache()\nordersByWeek2.cache()\nordersByWeek3.cache()\nordersByWeek4.cache()\nordersByWeek5.cache()\nordersByWeek6.cache()\nordersByWeek7.cache()","dateUpdated":"2018-08-25T21:10:18+0000"},{"text":"val ordersByMonth1 = ordersDSsimple.filter(r => r.month == 1)\nval ordersByMonth2 = ordersDSsimple.filter(r => r.month == 2)\nval ordersByMonth3 = ordersDSsimple.filter(r => r.month == 3)\nval ordersByMonth4 = ordersDSsimple.filter(r => r.month == 4)\nval ordersByMonth5 = ordersDSsimple.filter(r => r.month == 5)\nval ordersByMonth6 = ordersDSsimple.filter(r => r.month == 6)\nval ordersByMonth7 = ordersDSsimple.filter(r => r.month == 7)\nval ordersByMonth8 = ordersDSsimple.filter(r => r.month == 8)\nval ordersByMonth9 = ordersDSsimple.filter(r => r.month == 9)\nval ordersByMonth10 = ordersDSsimple.filter(r => r.month == 10)\nval ordersByMonth11 = ordersDSsimple.filter(r => r.month == 11)\nval ordersByMonth12 = ordersDSsimple.filter(r => r.month == 12)","user":"anonymous","dateUpdated":"2018-08-25T21:10:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"ordersByMonth1: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByMonth2: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByMonth3: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByMonth4: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByMonth5: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByMonth6: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByMonth7: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByMonth8: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByMonth9: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByMonth10: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByMonth11: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\nordersByMonth12: org.apache.spark.sql.Dataset[OrderRowSimple] = [day_of_week: int, month: int ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1535224194054_-1724884532","id":"20180825-190954_1314753341","dateCreated":"2018-08-25T19:09:54+0000","dateStarted":"2018-08-25T21:10:43+0000","dateFinished":"2018-08-25T21:10:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7865"},{"user":"anonymous","config":{"colWidth":12,"enabled":false,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535230926983_548389209","id":"20180825-210206_525710036","dateCreated":"2018-08-25T21:02:06+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8322","text":"ordersByMonth1.cache()\nordersByMonth2.cache()\nordersByMonth3.cache()\nordersByMonth4.cache()\nordersByMonth5.cache()\nordersByMonth6.cache()\nordersByMonth7.cache()\nordersByMonth8.cache()\nordersByMonth9.cache()\nordersByMonth10.cache()\nordersByMonth11.cache()\nordersByMonth12.cache()","dateUpdated":"2018-08-25T21:10:26+0000"},{"text":"//top10_products_by_gross_sales_$i\nsaveToFile(\n    ordersByWeek1.groupBy(\"product_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_sales\").orderBy($\"gross_sales\".desc).limit(10),\n    \"top10_products_by_gross_sales_1\"\n)\n    \nsaveToFile(\n    ordersByWeek2.groupBy(\"product_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_sales\").orderBy($\"gross_sales\".desc).limit(10),\n    \"top10_products_by_gross_sales_2\"\n)\n\nsaveToFile(\n    ordersByWeek3.groupBy(\"product_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_sales\").orderBy($\"gross_sales\".desc).limit(10),\n    \"top10_products_by_gross_sales_3\"\n)\n    \nsaveToFile(\n    ordersByWeek4.groupBy(\"product_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_sales\").orderBy($\"gross_sales\".desc).limit(10),\n    \"top10_products_by_gross_sales_4\"\n)\n    \nsaveToFile(\n    ordersByWeek5.groupBy(\"product_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_sales\").orderBy($\"gross_sales\".desc).limit(10),\n    \"top10_products_by_gross_sales_5\"\n)\n    \nsaveToFile(\n    ordersByWeek6.groupBy(\"product_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_sales\").orderBy($\"gross_sales\".desc).limit(10),\n    \"top10_products_by_gross_sales_6\"\n)\n    \nsaveToFile(\n    ordersByWeek7.groupBy(\"product_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_sales\").orderBy($\"gross_sales\".desc).limit(10),\n    \"top10_products_by_gross_sales_7\"\n)\n","user":"anonymous","dateUpdated":"2018-08-25T21:10:39+0000","config":{"tableHide":false,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535221455641_-1825258546","id":"20180823-202701_198085769","dateCreated":"2018-08-25T18:24:15+0000","dateStarted":"2018-08-25T21:10:43+0000","dateFinished":"2018-08-25T21:11:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7866"},{"text":"//top10_products_by_orders_$i\nsaveToFile(\n    ordersByWeek1.groupBy(\"product_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_products_by_orders_1\"\n)\nsaveToFile(\n    ordersByWeek2.groupBy(\"product_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_products_by_orders_2\"\n)\nsaveToFile(\n    ordersByWeek3.groupBy(\"product_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_products_by_orders_3\"\n)\nsaveToFile(\n    ordersByWeek4.groupBy(\"product_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_products_by_orders_4\"\n)\nsaveToFile(\n    ordersByWeek5.groupBy(\"product_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_products_by_orders_5\"\n)\nsaveToFile(\n    ordersByWeek6.groupBy(\"product_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_products_by_orders_6\"\n)\nsaveToFile(\n    ordersByWeek7.groupBy(\"product_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_products_by_orders_7\"\n)\n","user":"anonymous","dateUpdated":"2018-08-25T21:10:39+0000","config":{"tableHide":false,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535221455642_-1824104299","id":"20180823-203615_1445810839","dateCreated":"2018-08-25T18:24:15+0000","dateStarted":"2018-08-25T21:10:46+0000","dateFinished":"2018-08-25T21:12:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7867"},{"text":"//top10_customers_by_gross_spending_$i\nsaveToFile(\n    ordersByMonth1.groupBy(\"client_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_spending\").orderBy($\"gross_spending\".desc).limit(10),\n    \"top10_customers_by_gross_spending_1\"\n)\nsaveToFile(\n    ordersByMonth2.groupBy(\"client_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_spending\").orderBy($\"gross_spending\".desc).limit(10),\n    \"top10_customers_by_gross_spending_2\"\n)\nsaveToFile(\n    ordersByMonth3.groupBy(\"client_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_spending\").orderBy($\"gross_spending\".desc).limit(10),\n    \"top10_customers_by_gross_spending_3\"\n)\nsaveToFile(\n    ordersByMonth4.groupBy(\"client_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_spending\").orderBy($\"gross_spending\".desc).limit(10),\n    \"top10_customers_by_gross_spending_4\"\n)\nsaveToFile(\n    ordersByMonth5.groupBy(\"client_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_spending\").orderBy($\"gross_spending\".desc).limit(10),\n    \"top10_customers_by_gross_spending_5\"\n)\nsaveToFile(\n    ordersByMonth6.groupBy(\"client_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_spending\").orderBy($\"gross_spending\".desc).limit(10),\n    \"top10_customers_by_gross_spending_6\"\n)\nsaveToFile(\n    ordersByMonth7.groupBy(\"client_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_spending\").orderBy($\"gross_spending\".desc).limit(10),\n    \"top10_customers_by_gross_spending_7\"\n)\nsaveToFile(\n    ordersByMonth8.groupBy(\"client_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_spending\").orderBy($\"gross_spending\".desc).limit(10),\n    \"top10_customers_by_gross_spending_8\"\n)\nsaveToFile(\n    ordersByMonth9.groupBy(\"client_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_spending\").orderBy($\"gross_spending\".desc).limit(10),\n    \"top10_customers_by_gross_spending_9\"\n)\nsaveToFile(\n    ordersByMonth10.groupBy(\"client_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_spending\").orderBy($\"gross_spending\".desc).limit(10),\n    \"top10_customers_by_gross_spending_10\"\n)\nsaveToFile(\n    ordersByMonth11.groupBy(\"client_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_spending\").orderBy($\"gross_spending\".desc).limit(10),\n    \"top10_customers_by_gross_spending_11\"\n)\nsaveToFile(\n    ordersByMonth12.groupBy(\"client_id\").sum(\"total\").withColumnRenamed(\"sum(total)\",\"gross_spending\").orderBy($\"gross_spending\".desc).limit(10),\n    \"top10_customers_by_gross_spending_12\"\n)\n","user":"anonymous","dateUpdated":"2018-08-25T21:10:40+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535221455646_-1825643295","id":"20180823-212601_31790638","dateCreated":"2018-08-25T18:24:15+0000","dateStarted":"2018-08-25T21:11:39+0000","dateFinished":"2018-08-25T21:14:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7868"},{"text":"//top10_customers_by_orders_$i\nsaveToFile(\n    ordersByMonth1.groupBy(\"client_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_customers_by_orders_1\"\n)\nsaveToFile(\n    ordersByMonth2.groupBy(\"client_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_customers_by_orders_2\"\n)\nsaveToFile(\n    ordersByMonth3.groupBy(\"client_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_customers_by_orders_3\"\n)\nsaveToFile(\n    ordersByMonth4.groupBy(\"client_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_customers_by_orders_4\"\n)\nsaveToFile(\n    ordersByMonth5.groupBy(\"client_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_customers_by_orders_5\"\n)\nsaveToFile(\n    ordersByMonth6.groupBy(\"client_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_customers_by_orders_6\"\n)\nsaveToFile(\n    ordersByMonth7.groupBy(\"client_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_customers_by_orders_7\"\n)\nsaveToFile(\n    ordersByMonth8.groupBy(\"client_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_customers_by_orders_8\"\n)\nsaveToFile(\n    ordersByMonth9.groupBy(\"client_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_customers_by_orders_9\"\n)\nsaveToFile(\n    ordersByMonth10.groupBy(\"client_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_customers_by_orders_10\"\n)\nsaveToFile(\n    ordersByMonth11.groupBy(\"client_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_customers_by_orders_11\"\n)\nsaveToFile(\n    ordersByMonth12.groupBy(\"client_id\").count().withColumnRenamed(\"count\",\"orders_count\").orderBy($\"orders_count\".desc).limit(10),\n    \"top10_customers_by_orders_12\"\n)\n","user":"anonymous","dateUpdated":"2018-08-25T21:12:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535224383583_1643454695","id":"20180825-191303_387991896","dateCreated":"2018-08-25T19:13:03+0000","dateStarted":"2018-08-25T21:12:30+0000","dateFinished":"2018-08-25T21:15:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7869"},{"user":"anonymous","dateUpdated":"2018-08-25T19:44:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535224836893_-1416592870","id":"20180825-192036_536739005","dateCreated":"2018-08-25T19:20:36+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:7870"}],"name":"AlimazonC3","id":"2DPYFUUWY","angularObjects":{"2DR5Q8TJ5:shared_process":[],"2DQQXSRX8:shared_process":[],"2DQXA95DU:shared_process":[],"2DR3YZ32M:shared_process":[],"2DQXS8RSE:shared_process":[],"2DNFJK5RN:shared_process":[],"2DQE6R3D1:shared_process":[],"2DQ421M5M:shared_process":[],"2DQC97UR5:shared_process":[],"2DPWM6BMV:shared_process":[],"2DRJ1CVY3:shared_process":[],"2DRC7CJYM:shared_process":[],"2DPA8RCGR:shared_process":[],"2DQ9T9QJN:shared_process":[],"2DNP9NB9W:shared_process":[],"2DRFT985Y:shared_process":[],"2DNCJMR22:shared_process":[],"2DPFEEPT9:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}