{"paragraphs":[{"text":"import org.apache.spark.sql.types.{StructType, StringType, TimestampType, IntegerType, DoubleType, StructField}\nimport org.apache.spark.sql.{Dataset,SaveMode}","dateUpdated":"2018-08-30T18:13:01+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types.{StructType, StringType, TimestampType, IntegerType, DoubleType, StructField}\nimport org.apache.spark.sql.{Dataset, SaveMode}\n"}]},"apps":[],"jobName":"paragraph_1535652611964_213343175","id":"20180828-041011_1741550178","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:226","user":"anonymous","dateFinished":"2018-08-30T18:13:40+0000","dateStarted":"2018-08-30T18:13:01+0000"},{"text":"val struct =\n  StructType(\n    StructField(\"id\", StringType, false) ::\n    StructField(\"product_id\", StringType, false) ::\n    StructField(\"quantity\", IntegerType, false) ::\n    StructField(\"timestamp\", TimestampType, false) ::\n    StructField(\"total\", DoubleType, false) :: Nil)","dateUpdated":"2018-08-30T18:15:04+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"struct: org.apache.spark.sql.types.StructType = StructType(StructField(id,StringType,false), StructField(product_id,StringType,false), StructField(quantity,IntegerType,false), StructField(timestamp,TimestampType,false), StructField(total,DoubleType,false))\n"}]},"apps":[],"jobName":"paragraph_1535652611972_296833687","id":"20180828-041058_511369418","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:227","user":"anonymous","dateFinished":"2018-08-30T18:15:05+0000","dateStarted":"2018-08-30T18:15:04+0000"},{"text":"def saveToFile(ds:Dataset[Int],filename:String) = {\r\n            ds.write.mode(SaveMode.Overwrite)\r\n               .format(\"com.databricks.spark.csv\")\r\n               .option(\"header\", true)\r\n               .option(\"delimiter\", \",\")\r\n               .save(s\"gs://de-training-output-fherdelpino/assignment-5-tst/$filename\")\r\n        }","dateUpdated":"2018-08-30T18:15:08+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"saveToFile: (ds: org.apache.spark.sql.Dataset[Int], filename: String)Unit\n"}]},"apps":[],"jobName":"paragraph_1535652611972_296833687","id":"20180829-204004_358936377","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:228","user":"anonymous","dateFinished":"2018-08-30T18:15:09+0000","dateStarted":"2018-08-30T18:15:08+0000"},{"text":"val df = spark.read.schema(struct).json(\"gs://de-training-input/alimazon/200000/stock-orders\")\n    /*.sample(false,0.0003)\ndf.count()\ndf.show()*/","dateUpdated":"2018-08-30T18:15:11+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df: org.apache.spark.sql.DataFrame = [id: string, product_id: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1535652611973_296448938","id":"20180828-034529_443617618","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:229","user":"anonymous","dateFinished":"2018-08-30T18:15:19+0000","dateStarted":"2018-08-30T18:15:11+0000"},{"title":"Default partitions","text":"df.rdd.getNumPartitions\ndf.rdd.partitioner\ndf.rdd.glom().collect()","dateUpdated":"2018-08-30T18:15:31+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res2: Int = 5\nres3: Option[org.apache.spark.Partitioner] = None\nres4: Array[Array[org.apache.spark.sql.Row]] = Array(Array([1892bdb9-c042-4b01-88cf-3f6d328ac7f7,B001AGP90E,95,2018-07-01 00:00:00.0,1085.85], [c2643ed9-966a-497b-85aa-8e9dd38b9a73,0553572628,37,2018-07-03 00:00:00.0,1805.97], [9af498cf-e425-4e52-b5c5-d810ea380ef5,B000HBDXP6,63,2018-07-05 00:00:00.0,79.38], [2a95bb71-94a4-4017-a138-3424659b12e1,1935273647,60,2018-07-07 00:00:00.0,409.8], [5ec9a0e5-a97b-4592-b1d8-9dbee43d6b9e,B00LWE89CO,9,2018-07-09 00:00:00.0,617.13], [1f3a7226-ccd7-49cd-acb3-998f5d82cea7,B00HZYTGMM,53,2018-07-11 00:00:00.0,4823.53], [3353e2c5-4419-4ff9-81ad-45cdd16012f9,B00GLX0ZV4,97,2018-07-13 00:00:00.0,923.44], [9e9495da-6864-4d2e-8525-46c45c51c63c,0515153524,72,2018-07-15 00:00:00.0,1602.72], [3995d770-c10d-4c25-8ac0-3edb35ec9486,B004AZKIF8,19,2018-07-17 00:00:00.0..."}]},"apps":[],"jobName":"paragraph_1535652611973_296448938","id":"20180829-205606_1610358271","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:230","user":"anonymous","dateFinished":"2018-08-30T18:16:07+0000","dateStarted":"2018-08-30T18:15:31+0000"},{"text":"val default_partitions_size = df.mapPartitions(iter => Seq(iter.size).iterator)\ndefault_partitions_size.show()","dateUpdated":"2018-08-30T18:16:10+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"default_partitions_size: org.apache.spark.sql.Dataset[Int] = [value: int]\n+------+\n| value|\n+------+\n|155000|\n|155000|\n|155000|\n|155000|\n| 60002|\n+------+\n\n"}]},"apps":[],"jobName":"paragraph_1535652611974_297603185","id":"20180829-204002_664978681","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:231","user":"anonymous","dateFinished":"2018-08-30T18:16:25+0000","dateStarted":"2018-08-30T18:16:10+0000"},{"text":"saveToFile(default_partitions_size,\"default-partitions\")","dateUpdated":"2018-08-30T18:16:33+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535652611975_297218436","id":"20180829-205439_1195584214","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:232","user":"anonymous","dateFinished":"2018-08-30T18:16:52+0000","dateStarted":"2018-08-30T18:16:34+0000"},{"title":"Partition by ID","text":"val df_byId = df.repartition($\"id\")\n\ndf_byId.rdd.getNumPartitions\ndf_byId.rdd.partitioner\ndf_byId.rdd.glom().collect()","dateUpdated":"2018-08-30T18:16:58+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535652611975_297218436","id":"20180829-210453_1680021548","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:233","user":"anonymous","dateFinished":"2018-08-30T18:17:21+0000","dateStarted":"2018-08-30T18:16:58+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_byId: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: string, product_id: string ... 3 more fields]\nres8: Int = 200\nres9: Option[org.apache.spark.Partitioner] = None\nres10: Array[Array[org.apache.spark.sql.Row]] = Array(Array([c2643ed9-966a-497b-85aa-8e9dd38b9a73,0553572628,37,2018-07-03 00:00:00.0,1805.97], [16b737bd-7080-4162-bb0f-1d7de324099d,B00764EC52,12,2018-07-11 00:00:00.0,52.32], [f64f8492-381a-4ed1-8d15-e6d04e0eacd5,B00SNKL9AO,27,2018-07-09 00:00:00.0,266.76], [d4f91eb7-5a8a-463b-9cb9-2ecb1b0dd451,B001AYPH0I,44,2018-07-23 00:00:00.0,1587.96], [a0ad4406-4c35-4d40-b074-ac750ad0a30e,B000IMZVFY,78,2018-07-29 00:00:00.0,3481.92], [b3354477-e95a-4855-835f-42f881e8c0ab,B0073NGBNC,80,2018-07-17 00:00:00.0,274.4], [9af1b44a-8ad4-4a79-94dc-7f2b8cb9e6c0,0158107535,55,2018-07-03 00:00:00.0,1028.5], [62be08a3-3fc1-4eaf-98c4-5e33a0176472,B00FGAXHRM,26,2018-07-03 00:00:00.0,178.62], [2281640b-c53a-48f2-99ce-b6ac2e5ac176,B00GLMOTEE,49,2018-07-31 00:00:00...."}]}},{"text":"val id_partitions_size = df_byId.mapPartitions(iter => Seq(iter.size).iterator)\nid_partitions_size.show()","dateUpdated":"2018-08-30T18:18:00+0000","config":{"tableHide":true,"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"id_partitions_size: org.apache.spark.sql.Dataset[Int] = [value: int]\n+-----+\n|value|\n+-----+\n| 3380|\n| 3339|\n| 3363|\n| 3295|\n| 3370|\n| 3499|\n| 3316|\n| 3404|\n| 3444|\n| 3402|\n| 3438|\n| 3384|\n| 3340|\n| 3484|\n| 3381|\n| 3366|\n| 3385|\n| 3380|\n| 3473|\n| 3398|\n+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1535652611976_295294691","id":"20180828-040338_1450360914","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:234","user":"anonymous","dateFinished":"2018-08-30T18:18:13+0000","dateStarted":"2018-08-30T18:18:00+0000"},{"text":"saveToFile(id_partitions_size,\"id-partitions\")","dateUpdated":"2018-08-30T18:18:17+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535652611977_294909942","id":"20180828-045202_247064751","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:235","user":"anonymous","dateFinished":"2018-08-30T18:21:02+0000","dateStarted":"2018-08-30T18:18:17+0000"},{"title":"Partition by 15","text":"val df_by15 = df.repartition(15)\n\ndf_by15.rdd.getNumPartitions\ndf_by15.rdd.partitioner\ndf_by15.rdd.glom().collect()","dateUpdated":"2018-08-30T18:21:17+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_by15: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: string, product_id: string ... 3 more fields]\nres14: Int = 15\nres15: Option[org.apache.spark.Partitioner] = None\nres16: Array[Array[org.apache.spark.sql.Row]] = Array(Array([b15c46c0-2a7f-4b0a-9fd2-557200ddf375,B00B9GQ882,10,2018-07-31 00:00:00.0,74.0], [cb18b785-a204-4f95-b04c-d721abf7a492,B0078426WQ,30,2018-07-15 00:00:00.0,392.7], [d0ba93da-ce2f-4431-8b57-8131d4b62aeb,B0051V2BM8,19,2018-07-19 00:00:00.0,926.25], [c3956fe6-7fb3-4a65-827d-b019efed54e0,B00C075ACY,77,2018-07-23 00:00:00.0,577.5], [217b2a53-b12b-4efa-9c65-bc6f1347e69d,B004FTN5OA,44,2018-07-25 00:00:00.0,370.48], [8f12084a-2aa0-4230-bd9b-bcef7954623d,B00AOIA6WA,32,2018-07-31 00:00:00.0,842.24], [111bf2d7-e627-4f5f-827a-39d019e55cfa,B00LCVA0LK,60,2018-07-05 00:00:00.0,7418.4], [32fce81d-990a-4bf4-8d9d-045473e8249c,B00016JH0C,43,2018-07-11 00:00:00.0,3364.75], [bb1b6dda-88b6-4c83-9599-0fa4355d7a37,B00891U6TW,99,2018-07-15 00:00:00.0,13..."}]},"apps":[],"jobName":"paragraph_1535652611977_294909942","id":"20180829-210510_1384233396","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:236","user":"anonymous","dateFinished":"2018-08-30T18:21:34+0000","dateStarted":"2018-08-30T18:21:17+0000"},{"text":"val partitions_15_size = df_by15.mapPartitions(iter => Seq(iter.size).iterator)\npartitions_15_size.show()","dateUpdated":"2018-08-30T18:21:41+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"partitions_15_size: org.apache.spark.sql.Dataset[Int] = [value: int]\n+-----+\n|value|\n+-----+\n|45334|\n|45336|\n|45336|\n|45337|\n|45336|\n|45334|\n|45332|\n|45332|\n|45332|\n|45332|\n|45332|\n|45332|\n|45332|\n|45332|\n|45333|\n+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1535652611978_296064189","id":"20180829-210229_1189310330","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:237","user":"anonymous","dateFinished":"2018-08-30T18:21:52+0000","dateStarted":"2018-08-30T18:21:41+0000"},{"text":"saveToFile(partitions_15_size,\"fifteen-partitions\")","dateUpdated":"2018-08-30T18:21:59+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535652611978_296064189","id":"20180829-210417_1006844616","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:238","user":"anonymous","dateFinished":"2018-08-30T18:22:23+0000","dateStarted":"2018-08-30T18:21:59+0000"},{"title":"Partition by 15 and id","text":"val df_by15_byId = df.repartition(15,$\"id\")\n\ndf_by15_byId.rdd.getNumPartitions\ndf_by15_byId.rdd.partitioner\ndf_by15_byId.rdd.glom().collect()","dateUpdated":"2018-08-30T18:22:28+0000","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_by15_byId: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: string, product_id: string ... 3 more fields]\nres20: Int = 15\nres21: Option[org.apache.spark.Partitioner] = None\nres22: Array[Array[org.apache.spark.sql.Row]] = Array(Array([3b42468f-489c-4192-8358-24cd85502b90,B004Y8KRFC,70,2018-07-21 00:00:00.0,424.2], [b49e4836-05fd-4b54-998a-39093747fc9d,B001BPFCOC,77,2018-07-01 00:00:00.0,1035.65], [1c5dbfea-f33d-4b6a-902d-2a10da66d077,B0087D94MW,88,2018-07-05 00:00:00.0,2778.16], [5ad03a7a-19fc-4102-ad44-3f3b7748576b,B00XK28VII,50,2018-07-19 00:00:00.0,1855.5], [5a9b9521-2db9-4c59-8815-c643fd926292,B00I4ZUXM8,44,2018-07-01 00:00:00.0,3830.64], [e4d13fd3-be7b-47f6-8b7e-33c3f18a3dd1,B0046BAB4O,13,2018-07-17 00:00:00.0,340.21], [c7362800-a5e6-4eba-9bb5-27a410c03d99,B005OPE61U,87,2018-07-19 00:00:00.0,2636.1], [e43b8e4f-47ef-4904-b374-f7817504bc1b,B000O7DY48,56,2018-07-27 00:00:00.0,324.24], [4fafbb03-62bf-44d6-9ed2-6c6476c738fa,B0006C4KP8,53,2018-07-29 00:00:00..."}]},"apps":[],"jobName":"paragraph_1535652611979_295679440","id":"20180829-212030_1123097886","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:239","user":"anonymous","dateFinished":"2018-08-30T18:22:41+0000","dateStarted":"2018-08-30T18:22:28+0000"},{"text":"val df_by15_byId_size = df_by15_byId.mapPartitions(iter => Seq(iter.size).iterator)\ndf_by15_byId_size.show()","dateUpdated":"2018-08-30T18:22:53+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_by15_byId_size: org.apache.spark.sql.Dataset[Int] = [value: int]\n+-----+\n|value|\n+-----+\n|45510|\n|45479|\n|45323|\n|45247|\n|45335|\n|45497|\n|45590|\n|45534|\n|45340|\n|45112|\n|45401|\n|45100|\n|45234|\n|45469|\n|44831|\n+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1535652611979_295679440","id":"20180829-212112_1211790789","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:240","user":"anonymous","dateFinished":"2018-08-30T18:23:03+0000","dateStarted":"2018-08-30T18:22:53+0000"},{"dateUpdated":"2018-08-30T18:26:14+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535652611980_293755696","id":"20180829-212508_171845754","dateCreated":"2018-08-30T18:10:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:241","text":"saveToFile(df_by15_byId_size,\"fifteen-client_id-partitions\")","user":"anonymous","dateFinished":"2018-08-30T18:26:58+0000","dateStarted":"2018-08-30T18:26:14+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535653574457_-237638899","id":"20180830-182614_1740095206","dateCreated":"2018-08-30T18:26:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1371","dateUpdated":"2018-08-30T18:38:47+0000","dateFinished":"2018-08-30T18:38:50+0000","dateStarted":"2018-08-30T18:38:47+0000","title":"Partition by 15, product_id and month","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_month: org.apache.spark.sql.DataFrame = [id: string, product_id: string ... 3 more fields]\n+--------------------+----------+--------+-----+-------+\n|                  id|product_id|quantity|month|  total|\n+--------------------+----------+--------+-----+-------+\n|1892bdb9-c042-4b0...|B001AGP90E|      95|    7|1085.85|\n|c2643ed9-966a-497...|0553572628|      37|    7|1805.97|\n|9af498cf-e425-4e5...|B000HBDXP6|      63|    7|  79.38|\n|2a95bb71-94a4-401...|1935273647|      60|    7|  409.8|\n|5ec9a0e5-a97b-459...|B00LWE89CO|       9|    7| 617.13|\n|1f3a7226-ccd7-49c...|B00HZYTGMM|      53|    7|4823.53|\n|3353e2c5-4419-4ff...|B00GLX0ZV4|      97|    7| 923.44|\n|9e9495da-6864-4d2...|0515153524|      72|    7|1602.72|\n|3995d770-c10d-4c2...|B004AZKIF8|      19|    7| 466.64|\n|8651af77-3280-435...|B0056QFV9I|      32|    7|  72.64|\n|4eeb327e-789e-4fd...|B004RQWRJK|      30|    7| 2486.7|\n|52914855-36f7-4fc...|B00X3EZUTG|      15|    7|  40.95|\n|746ac514-6b3d-41f...|B0008F6BGE|      41|    7| 798.68|\n|f6a5346f-4735-4a7...|B00DWYUG3M|      93|    7|2131.56|\n|b15c46c0-2a7f-4b0...|B00B9GQ882|      10|    7|   74.0|\n|2e2fd92f-b391-40c...|B00KF47AOU|       4|    7|  59.24|\n|76ca295a-e3a6-437...|0739039652|      54|    7|1432.62|\n|db372f50-8f81-4a8...|B00NVU3PZS|      47|    7| 716.28|\n|bd03cf18-db3f-473...|B00MCVOTA2|      96|    7|2794.56|\n|29f0d269-0884-421...|B00HXQM296|      43|    7|1136.06|\n+--------------------+----------+--------+-----+-------+\nonly showing top 20 rows\n\n"}]},"text":"df.createOrReplaceTempView(\"stock_orders\")\nval df_month = spark.sql(\"select id, product_id, quantity, month(timestamp) month, total from stock_orders\")\ndf_month.show()\n"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535654306018_-921292842","id":"20180830-183826_1440556656","dateCreated":"2018-08-30T18:38:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1473","text":"val df_by15_byProduct_id_month = df_month.repartition(15,$\"product_id\",$\"month\")","dateUpdated":"2018-08-30T18:40:05+0000","dateFinished":"2018-08-30T18:40:05+0000","dateStarted":"2018-08-30T18:40:05+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_by15_byProduct_id_month: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: string, product_id: string ... 3 more fields]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535654354054_-1790394635","id":"20180830-183914_884659939","dateCreated":"2018-08-30T18:39:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1560","text":"df_by15_byProduct_id_month.rdd.getNumPartitions\ndf_by15_byProduct_id_month.rdd.partitioner\ndf_by15_byProduct_id_month.rdd.glom().collect()","dateUpdated":"2018-08-30T18:40:07+0000","dateFinished":"2018-08-30T18:40:37+0000","dateStarted":"2018-08-30T18:40:07+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res27: Int = 15\nres28: Option[org.apache.spark.Partitioner] = None\nres29: Array[Array[org.apache.spark.sql.Row]] = Array(Array([2a95bb71-94a4-4017-a138-3424659b12e1,1935273647,60,7,409.8], [1f3a7226-ccd7-49cd-acb3-998f5d82cea7,B00HZYTGMM,53,7,4823.53], [db372f50-8f81-4a8f-8283-3492bed0145d,B00NVU3PZS,47,7,716.28], [74f7fb4f-c04e-4690-befb-eb7c16a2fd1b,B00INK5U2M,85,7,1360.85], [8b8af882-a923-49ad-a14c-507e6e821d90,B004YM2OOU,96,7,1747.2], [c80ecc62-e6c6-4b3e-a3cf-8a0a03c602cb,B00PZ8JEP4,8,7,261.36], [63c5e563-e962-451f-bf86-92a9c49d28d4,1492760609,9,7,34.47], [83575e64-034c-4f9e-8ad1-22aef59312df,B00WDSGR4K,68,7,7238.6], [08a3d358-17f7-4764-9395-747ca1e68d9d,B00J5YZDI6,81,7,5377.59], [b64b3318-cec1-4c63-8294-3fd3e6f9d9b7,B009IKMYYI,91,7,2334.15], [fe3043d3-529a-4e0c-bc31-cc14c614b5a9,B00HA6WUKA,85,7,2502.4], [904c0e64-90aa-43aa-a60c-3cda8c28ef12,B012KS..."}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535654407512_-740891581","id":"20180830-184007_26921988","dateCreated":"2018-08-30T18:40:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1671","text":"val df_by15_byProduct_id_month_size = df_by15_byProduct_id_month.mapPartitions(iter => Seq(iter.size).iterator)\ndf_by15_byProduct_id_month_size.show()","dateUpdated":"2018-08-30T18:41:10+0000","dateFinished":"2018-08-30T18:41:22+0000","dateStarted":"2018-08-30T18:41:10+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_by15_byProduct_id_month_size: org.apache.spark.sql.Dataset[Int] = [value: int]\n+-----+\n|value|\n+-----+\n|45605|\n|45541|\n|46287|\n|44032|\n|45508|\n|44982|\n|44973|\n|44611|\n|45131|\n|45076|\n|46165|\n|45771|\n|45022|\n|45758|\n|45540|\n+-----+\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535654461786_1462858174","id":"20180830-184101_1629290108","dateCreated":"2018-08-30T18:41:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1760","text":"saveToFile(df_by15_byProduct_id_month_size,\"fifteen-product_id-month-partitions\")","dateUpdated":"2018-08-30T18:42:40+0000","dateFinished":"2018-08-30T18:43:18+0000","dateStarted":"2018-08-30T18:42:40+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535654560878_-292645433","id":"20180830-184240_434670185","dateCreated":"2018-08-30T18:42:40+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1881"}],"name":"C5","id":"2DN894JH2","angularObjects":{"2DQWJKJZV:shared_process":[],"2DPACY4Y6:shared_process":[],"2DPQDJRRT:shared_process":[],"2DRZE8584:shared_process":[],"2DQCCPG3B:shared_process":[],"2DRJKCRCT:shared_process":[],"2DNCDNFU8:shared_process":[],"2DPD9QH9T:shared_process":[],"2DRRYG7WR:shared_process":[],"2DR2JD8MZ:shared_process":[],"2DR3CT13T:shared_process":[],"2DQ4JJQYA:shared_process":[],"2DNK66HUB:shared_process":[],"2DR53UGYZ:shared_process":[],"2DRVNVBKY:shared_process":[],"2DPTABC22:shared_process":[],"2DR85971D:shared_process":[],"2DQDVHEAT:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}