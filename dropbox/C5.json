{"paragraphs":[{"text":"import org.apache.spark.sql.types.{StructType, StringType, TimestampType, IntegerType, DoubleType, StructField}","user":"anonymous","dateUpdated":"2018-08-28T04:14:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types.{StructType, StringType, TimestampType, IntegerType, DoubleType, StructField}\n"}]},"apps":[],"jobName":"paragraph_1535429411736_1092514258","id":"20180828-041011_1741550178","dateCreated":"2018-08-28T04:10:11+0000","dateStarted":"2018-08-28T04:14:37+0000","dateFinished":"2018-08-28T04:14:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4767"},{"text":"val struct =\n  StructType(\n    StructField(\"id\", StringType, false) ::\n    StructField(\"product_id\", StringType, false) ::\n    StructField(\"quantity\", IntegerType, false) ::\n    StructField(\"timestamp\", TimestampType, false) ::\n    StructField(\"total\", DoubleType, false) :: Nil)","user":"anonymous","dateUpdated":"2018-08-28T04:14:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"struct: org.apache.spark.sql.types.StructType = StructType(StructField(id,StringType,false), StructField(product_id,StringType,false), StructField(quantity,IntegerType,false), StructField(timestamp,TimestampType,false), StructField(total,DoubleType,false))\n"}]},"apps":[],"jobName":"paragraph_1535429458272_-420071586","id":"20180828-041058_511369418","dateCreated":"2018-08-28T04:10:58+0000","dateStarted":"2018-08-28T04:13:43+0000","dateFinished":"2018-08-28T04:13:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4768"},{"text":"val df = spark.read.schema(struct).json(\"gs://de-training-input/alimazon/200000/stock-orders\")\n    /*.sample(false,0.0003)\ndf.count()\ndf.show()*/","user":"anonymous","dateUpdated":"2018-08-28T04:53:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df: org.apache.spark.sql.DataFrame = [id: string, product_id: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1535427929748_-674747998","id":"20180828-034529_443617618","dateCreated":"2018-08-28T03:45:29+0000","dateStarted":"2018-08-28T04:53:09+0000","dateFinished":"2018-08-28T04:53:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4769"},{"text":"val df2 = df.repartition($\"id\")","user":"anonymous","dateUpdated":"2018-08-28T04:19:05+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df2: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: string, product_id: string ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1535429890360_2071176421","id":"20180828-041810_706201682","dateCreated":"2018-08-28T04:18:10+0000","dateStarted":"2018-08-28T04:19:05+0000","dateFinished":"2018-08-28T04:19:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4770"},{"text":"df2.rdd.getNumPartitions\ndf2.rdd.partitioner\ndf2.rdd.glom().collect()","user":"anonymous","dateUpdated":"2018-08-28T04:19:36+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":161,"optionOpen":false}}},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res60: Int = 200\nres61: Option[org.apache.spark.Partitioner] = None\nres62: Array[Array[org.apache.spark.sql.Row]] = Array(Array([91766c4f-227f-48c2-86a8-131422a9699e,B000WP20B0,8,2018-07-17 00:00:00.0,866.0], [3d02fb0d-20c1-4945-b52e-56d4e55d4183,B00LXTVIXU,31,2018-07-21 00:00:00.0,197.78]), Array([f8207deb-03ca-4e36-9fa5-08c8a38a24b6,B005P21E6M,19,2018-07-27 00:00:00.0,1098.77]), Array([3e9414cd-b001-4e49-90f0-7a8ab199f404,B00IS6VOJO,59,2018-07-29 00:00:00.0,4720.59], [db1b68f6-1dba-4b69-aaa7-285977e802f0,B0002E54WI,4,2018-07-07 00:00:00.0,197.32]), Array([04f10d55-dc0e-4b1a-b17b-5aceb09055d1,B000Q0NPOM,81,2018-07-07 00:00:00.0,2621.97], [5b55d727-ab86-43d1-a5a5-23180e8ab04c,161933898X,22,2018-07-27 00:00:00.0,1000.56]), Array([ccdaf61b-a727-4867-85d7-9f7997640571,1130324850,33,2018-07-11 00:00:00.0,608.19], [0ccd58be-da01-4147-9190-6a24833fa576,B002HE..."}]},"apps":[],"jobName":"paragraph_1535427998051_945337675","id":"20180828-034638_1096188684","dateCreated":"2018-08-28T03:46:38+0000","dateStarted":"2018-08-28T04:19:08+0000","dateFinished":"2018-08-28T04:19:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4771"},{"text":"val partitions = df.mapPartitions(iter => Seq(iter.size).iterator)\npartitions.show()","user":"anonymous","dateUpdated":"2018-08-28T04:55:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535429018011_35859150","id":"20180828-040338_1450360914","dateCreated":"2018-08-28T04:03:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4772","dateFinished":"2018-08-28T04:55:42+0000","dateStarted":"2018-08-28T04:55:19+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"partitions: org.apache.spark.sql.Dataset[Int] = [value: int]\n+------+\n| value|\n+------+\n|155000|\n|155000|\n|155000|\n|155000|\n| 60002|\n+------+\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535431922188_-2103992760","id":"20180828-045202_247064751","dateCreated":"2018-08-28T04:52:02+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5093"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535431853129_949481780","id":"20180828-045053_2137137818","dateCreated":"2018-08-28T04:50:53+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4999"}],"name":"C5","id":"2DNNDVKHS","angularObjects":{"2DR23JAHE:shared_process":[],"2DPZG7AD1:shared_process":[],"2DNJC16HV:shared_process":[],"2DR8T8E8R:shared_process":[],"2DQAYZ28Y:shared_process":[],"2DPJK62W4:shared_process":[],"2DRB1HNA6:shared_process":[],"2DQ85QMDH:shared_process":[],"2DPC6GHPU:shared_process":[],"2DQDQD6AJ:shared_process":[],"2DQTQA2DU:shared_process":[],"2DNDBUDKJ:shared_process":[],"2DQXQ4FTE:shared_process":[],"2DR7GUMDP:shared_process":[],"2DNVE88ED:shared_process":[],"2DPTH6RSG:shared_process":[],"2DPWWVWY6:shared_process":[],"2DNEFTQH4:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}